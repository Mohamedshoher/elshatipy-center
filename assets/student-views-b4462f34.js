import{j as e,a as t,U as a,F as l,A as n,T as r,W as s,C as o,c as i,d,e as c,f as m,g as h,h as u}from"./teacher-views-87eec1c8.js";import{r as g}from"./vendor-79b9f383.js";import{C as p,a as b}from"./director-views-1247b421.js";const x=({className:a})=>e("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t("rect",{x:"3",y:"3",width:"18",height:"5",rx:"2",ry:"2"}),t("path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8"}),t("path",{d:"M10 12h4"})]}),f=({student:m,groupName:h,onEdit:u,onToggleAttendance:g,onArchive:f,currentUserRole:w,onViewDetails:N,onDeletePermanently:y,onMarkWeeklyReportSent:v})=>{const D=(new Date).toISOString().split("T")[0],k=m.attendance.find(e=>e.date===D);return t("div",{className:"bg-white rounded-xl shadow-md overflow-hidden transition-all duration-300 ease-in-out hover:shadow-lg "+(m.isArchived?"bg-gray-100":""),children:t("div",{className:"p-4",onClick:()=>!m.isArchived&&N(m),role:"button",tabIndex:0,onKeyDown:e=>"Enter"===e.key&&!m.isArchived&&N(m),children:e("div",{className:"flex flex-col gap-2",children:[t("div",{className:"w-full flex items-center justify-between gap-3",children:e("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[t(a,{className:"w-8 h-8 text-blue-500 flex-shrink-0"}),e("div",{className:"flex items-baseline gap-3 min-w-0 flex-1",children:[t("h3",{className:(m.name.length>25?"text-base":m.name.length>18?"text-lg":"text-xl")+" font-bold text-gray-800",children:m.name}),h&&t("span",{className:"text-xs text-gray-500 whitespace-nowrap mr-auto",children:h})]})]})}),e("div",{className:"w-full flex items-center justify-between flex-nowrap",onClick:e=>e.stopPropagation(),children:[t("div",{className:"flex gap-2 flex-shrink-0",children:m.isArchived?e(l,{children:["teacher"!==w&&t("button",{onClick:e=>{e.stopPropagation(),f(m.id)},className:"py-1 px-3 rounded-full font-semibold text-sm bg-green-600 text-white shadow hover:bg-green-700 transition-all","aria-label":`Ø§Ø³ØªØ¹Ø§Ø¯Ø© ${m.name}`,children:"Ø§Ø³ØªØ¹Ø§Ø¯Ø©"}),"director"===w&&y&&t("button",{onClick:e=>{e.stopPropagation(),y(m.id)},className:"p-2 rounded-full font-semibold text-sm bg-red-100 text-red-600 shadow hover:bg-red-200 transition-all","aria-label":`Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù€ ${m.name}`,children:t(r,{className:"w-5 h-5"})})]}):e(l,{children:[t("button",{onClick:()=>g(m.id,D,n.PRESENT),className:"py-1 px-3 rounded-full font-semibold text-sm transition-all border "+(k?.status===n.PRESENT?"bg-green-600 text-white border-transparent shadow":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),"aria-label":`ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ù„Ù€ ${m.name}`,children:"Ø­Ø§Ø¶Ø±"}),t("button",{onClick:()=>g(m.id,D,n.ABSENT),className:"py-1 px-3 rounded-full font-semibold text-sm transition-all border "+(k?.status===n.ABSENT?"bg-red-600 text-white border-transparent shadow":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),"aria-label":`ØªØ³Ø¬ÙŠÙ„ ØºÙŠØ§Ø¨ Ù„Ù€ ${m.name}`,children:"ØºÙŠØ§Ø¨"})]})}),e("div",{className:"flex items-center gap-x-1 sm:gap-x-2 flex-shrink-0",children:[("director"===w||"supervisor"===w)&&(()=>{const e=new Date,a=(e.getDay()+1)%7,l=new Date(e);l.setDate(e.getDate()-a),l.setHours(0,0,0,0);const r=m.lastWeeklyReportDate&&new Date(m.lastWeeklyReportDate)>=l;return t("button",{onClick:e=>{if(e.stopPropagation(),e.preventDefault(),r)return;const t=new Date(l);t.setDate(l.getDate()+6),t.setHours(23,59,59,999);const a=e=>{const a=new Date(e);return a>=l&&a<=t},s=(m.attendance||[]).filter(e=>a(e.date)),o=s.filter(e=>e.status===n.PRESENT).length,i=s.filter(e=>e.status===n.ABSENT).length,h=(m.tests||[]).filter(e=>a(e.date)),u={[d.EXCELLENT]:"Ù…Ù…ØªØ§Ø²",[d.VERY_GOOD]:"Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹",[d.GOOD]:"Ø¬ÙŠØ¯",[d.REPEAT]:"Ø¥Ø¹Ø§Ø¯Ø©"};let g=`Ù…Ø±Ø­Ø¨Ø§Ù‹ ÙˆÙ„ÙŠ Ø£Ù…Ø± Ø§Ù„Ø·Ø§Ù„Ø¨/Ø©: *${m.name}*\n`;if(g+="Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ Ù…Ù† Ù…Ø±ÙƒØ² Ø§Ù„Ø´Ø§Ø·Ø¨ÙŠ:\n\n",g+="*ğŸ“ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨:*\n",g+=`  - Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±: ${o}\n`,g+=`  - Ø£ÙŠØ§Ù… Ø§Ù„ØºÙŠØ§Ø¨: ${i}\n\n`,g+="*ğŸ“– Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª:*\n",h.length>0){const e=h.find(e=>e.type===c.NEW),t=h.find(e=>e.type===c.RECENT_PAST),a=h.find(e=>e.type===c.DISTANT_PAST);e&&(g+=`  - Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${e.suraName} / ${u[e.grade]||""}\n`),t&&(g+=`  - Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø§Ù„Ù‚Ø±ÙŠØ¨: ${t.suraName} / ${u[t.grade]||""}\n`),a&&(g+=`  - Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø§Ù„Ø¨Ø¹ÙŠØ¯: ${a.suraName} / ${u[a.grade]||""}\n`)}else g+="  - Ù„Ù… ØªØ³Ø¬Ù„ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹.\n";g+="\nÙ…Ø¹ ØªØ­ÙŠØ§Øª Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ².";let p=m.phone.replace(/[^0-9]/g,"");p=p.replace(/^0+/,""),p.startsWith("1")&&10===p.length&&(p="20"+p);const b=encodeURIComponent(g);/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)?window.open(`https://api.whatsapp.com/send?phone=${p}&text=${b}`,"_blank"):window.open(`https://web.whatsapp.com/send?phone=${p}&text=${b}`,"whatsapp_window"),v&&v(m.id)},className:"p-1 transition-colors "+(r?"text-green-600 cursor-default":"text-green-500 hover:text-green-600"),title:r?"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ":"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ",disabled:!!r,children:t(r?p:s,{className:"w-5 h-5"})})})(),t("button",{onClick:e=>{e.stopPropagation(),N(m,"fees")},className:"p-1 text-gray-400 hover:text-yellow-500 transition-colors","aria-label":`Ù…ØµØ±ÙˆÙØ§Øª ${m.name}`,children:t(o,{className:"w-5 h-5"})}),t("button",{onClick:e=>{e.stopPropagation(),N(m,"tests")},className:"p-1 text-gray-400 hover:text-indigo-500 transition-colors","aria-label":`Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ${m.name}`,children:t(b,{className:"w-5 h-5"})}),m.isArchived?null:"teacher"!==w&&t("button",{onClick:e=>{e.stopPropagation(),f(m.id)},className:"p-1 text-gray-400 hover:text-orange-500 transition-colors","aria-label":`Ø£Ø±Ø´ÙØ© ${m.name}`,children:t(x,{className:"w-5 h-5"})}),"director"===w&&t("button",{onClick:e=>{e.stopPropagation(),u(m)},className:"p-1 text-gray-400 hover:text-blue-600 transition-colors","aria-label":`ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨ ${m.name}`,children:t(i,{className:"w-5 h-5"})})]})]})]})})})},w=a=>{const{students:l,searchTerm:n,groups:r,currentUserRole:s,onViewDetails:o,typeFilter:i,onTypeFilterChange:d}=a,c=g.useMemo(()=>{let e=l.filter(e=>e.name.toLowerCase().includes(n.toLowerCase())).filter(e=>{if("all"===i)return!0;const t=r.find(t=>t.id===e.groupId);return(e=>{if(!e)return null;const t=e.toLowerCase();return t.includes("Ù‚Ø±Ø¢Ù†")?"Ù‚Ø±Ø¢Ù†":t.includes("Ù†ÙˆØ± Ø¨ÙŠØ§Ù†")?"Ù†ÙˆØ± Ø¨ÙŠØ§Ù†":t.includes("ØªÙ„Ù‚ÙŠÙ†")||t.includes("ØªÙ‚Ù„ÙŠÙ†")?"ØªÙ„Ù‚ÙŠÙ†":t.includes("Ø¥Ù‚Ø±Ø§Ø¡")||t.includes("Ø§Ù‚Ø±Ø§Ø¡")?"Ø¥Ù‚Ø±Ø§Ø¡":null})(t?.name)===i});return e.sort((e,t)=>{if(n){const a=n.toLowerCase(),l=e.name.toLowerCase(),r=t.name.toLowerCase(),s=l.startsWith(a),o=r.startsWith(a);if(s&&!o)return-1;if(!s&&o)return 1}return e.name.localeCompare(t.name,"ar")}),e},[l,n,r,i]);return e("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["director"===s&&t("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:e("div",{className:"relative inline-block w-full sm:w-64",children:[t("label",{htmlFor:"type-filter",className:"block text-sm font-medium text-gray-700 mb-1 mr-1",children:"ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹"}),e("div",{className:"relative",children:[e("select",{id:"type-filter",value:i,onChange:e=>{d(e.target.value)},className:"block w-full appearance-none bg-white border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded-xl leading-tight focus:outline-none focus:bg-white focus:border-blue-500 focus:ring-2 focus:ring-blue-200 shadow-sm transition-all duration-200 font-bold",children:[t("option",{value:"all",children:"Ø§Ù„ÙƒÙ„"}),t("option",{value:"Ù‚Ø±Ø¢Ù†",children:"Ù‚Ø±Ø¢Ù†"}),t("option",{value:"Ù†ÙˆØ± Ø¨ÙŠØ§Ù†",children:"Ù†ÙˆØ± Ø¨ÙŠØ§Ù†"}),t("option",{value:"ØªÙ„Ù‚ÙŠÙ†",children:"ØªÙ„Ù‚ÙŠÙ†"}),t("option",{value:"Ø¥Ù‚Ø±Ø§Ø¡",children:"Ø¥Ù‚Ø±Ø§Ø¡"})]}),t("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center px-2 text-gray-700",children:t("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:t("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]})}),"director"!==s&&c.length>0&&e("div",{className:"mb-4 text-left",children:[t("span",{className:"text-gray-500 text-sm ml-2",children:"Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨:"}),t("span",{className:"font-bold text-gray-800",children:c.length})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:c.length>0?c.map(e=>t(f,{student:e,groupName:r.find(t=>t.id===e.groupId)?.name,onOpenFeeModal:a.onOpenFeeModal,onEdit:a.onEdit,onToggleAttendance:a.onToggleAttendance,onArchive:a.onArchive,currentUserRole:a.currentUserRole,onViewDetails:o,onMarkWeeklyReportSent:a.onMarkWeeklyReportSent},e.id)):e("div",{className:"col-span-1 md:col-span-2 text-center py-20 bg-white rounded-xl shadow",children:[t("h2",{className:"text-2xl font-semibold text-gray-600",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø§Ø¨"}),t("p",{className:"text-gray-400 mt-2",children:n||"all"!==i?"Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø·Ù„Ø§Ø¨ ÙŠØ·Ø§Ø¨Ù‚ÙˆÙ† Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªØµÙÙŠØ©.":"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø§Ø¨ Ù†Ø´Ø·ÙˆÙ† Ù„Ø¹Ø±Ø¶Ù‡Ù…."})]})})]})},N=()=>{const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},y=({isOpen:a,onClose:l,onSave:n,studentToEdit:r,groups:s})=>{const[o,i]=g.useState(""),[d,c]=g.useState(""),[m,h]=g.useState(""),[u,p]=g.useState(N()),[b,x]=g.useState("");if(g.useEffect(()=>{a&&(r?(i(r.name),c(r.phone),h(r.monthlyFee.toString()),p(r.joiningDate),x(r.groupId)):(i(""),c(""),h(""),p(N()),x(s[0]?.id||"")))},[r,a,s]),!a)return null;return t("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:e("div",{className:"bg-white rounded-lg shadow-2xl p-6 sm:p-8 w-full max-w-lg overflow-y-auto max-h-[90vh]",children:[t("h2",{className:"text-2xl font-bold mb-6 text-gray-700",children:r?"ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨":"Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯"}),e("form",{onSubmit:e=>{e.preventDefault(),o&&d&&m&&u&&b?0!==s.length?(n({name:o,phone:d,monthlyFee:parseFloat(m),joiningDate:u,groupId:b,isArchived:r?.isArchived??!1},r?.id),l()):alert("ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø£ÙˆÙ„Ø§Ù‹ Ù‚Ø¨Ù„ Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨."):alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ØŒ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¬Ù…ÙˆØ¹Ø©.")},children:[e("div",{className:"mb-4",children:[t("label",{htmlFor:"name",className:"block text-gray-600 mb-2",children:"Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨"}),t("input",{type:"text",id:"name",value:o,onChange:e=>i(e.target.value),className:"w-full px-4 py-2 border rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e("div",{className:"mb-4",children:[t("label",{htmlFor:"phone",className:"block text-gray-600 mb-2",children:"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ù…Ø¹ Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©)"}),t("input",{type:"tel",id:"phone",value:d,onChange:e=>c(e.target.value),placeholder:"Ù…Ø«Ø§Ù„: 966501234567",className:"w-full px-4 py-2 border rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e("div",{className:"mb-4",children:[t("label",{htmlFor:"monthlyFee",className:"block text-gray-600 mb-2",children:"Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©"}),t("input",{type:"number",id:"monthlyFee",value:m,onChange:e=>h(e.target.value),className:"w-full px-4 py-2 border rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e("div",{className:"mb-4",children:[t("label",{htmlFor:"group",className:"block text-gray-600 mb-2",children:"Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©"}),t("select",{id:"group",value:b,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",required:!0,disabled:0===s.length,children:0===s.length?t("option",{children:"ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø£ÙˆÙ„Ø§Ù‹"}):[...s].sort((e,t)=>e.name.localeCompare(t.name,"ar")).map(e=>t("option",{value:e.id,children:e.name},e.id))})]}),e("div",{className:"mb-6",children:[t("label",{htmlFor:"joiningDate",className:"block text-gray-600 mb-2",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… (ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯Ø®ÙˆÙ„)"}),t("input",{type:"date",id:"joiningDate",value:u,onChange:e=>p(e.target.value),className:"w-full px-4 py-2 border rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e("div",{className:"flex flex-col sm:flex-row justify-end gap-4",children:[t("button",{type:"button",onClick:l,className:"px-6 py-2 rounded-lg text-gray-700 bg-gray-200 hover:bg-gray-300 transition-colors order-2 sm:order-1",children:"Ø¥Ù„ØºØ§Ø¡"}),t("button",{type:"submit",className:"px-6 py-2 rounded-lg text-white bg-blue-600 hover:bg-blue-700 transition-colors order-1 sm:order-2",children:"Ø­ÙØ¸"})]})]})]})})},v=({className:a})=>e("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t("circle",{cx:"6",cy:"19",r:"3"}),t("path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"}),t("circle",{cx:"18",cy:"5",r:"3"})]}),D=({className:e="w-6 h-6"})=>t("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),k={[c.NEW]:"Ø¬Ø¯ÙŠØ¯",[c.RECENT_PAST]:"Ù…Ø§Ø¶ÙŠ Ù‚Ø±ÙŠØ¨",[c.DISTANT_PAST]:"Ø¨Ø¹ÙŠØ¯",[c.READING]:"Ù‚Ø±Ø§Ø¡Ø©"},S={[d.EXCELLENT]:{label:"Ù…Ù…ØªØ§Ø²",className:"bg-green-100 text-green-800"},[d.VERY_GOOD]:{label:"Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹",className:"bg-blue-100 text-blue-800"},[d.GOOD]:{label:"Ø¬ÙŠØ¯",className:"bg-yellow-100 text-yellow-800"},[d.REPEAT]:{label:"ÙŠØ¹Ø§Ø¯",className:"bg-red-100 text-red-800"}},T=a=>{const{student:l,initialTab:x,currentUser:f,notes:w,onOpenFeeModal:N,onAddTest:y,onDeleteTest:T,onAddNote:C,onSaveProgressPlan:E,onUpdatePlanRecord:P,onTogglePlanCompletion:$,onDeletePlanRecord:A,onCancelFeePayment:j,onBack:L}=a,[R,_]=g.useState(x),[M,F]=g.useState(""),[W,I]=g.useState(c.NEW),[O,G]=g.useState(d.EXCELLENT),[B,U]=g.useState(""),[Y,H]=g.useState("all"),[q,V]=g.useState("all"),[X,z]=g.useState("desc"),[K,J]=g.useState("all"),[Q,Z]=g.useState("desc"),[ee,te]=g.useState(()=>(new Date).toISOString().substring(0,7)),[ae,le]=g.useState({}),[ne,re]=g.useState(null);g.useState({}),g.useEffect(()=>{_(x),le({[c.NEW]:"",[c.RECENT_PAST]:"",[c.DISTANT_PAST]:""}),re(null)},[l.id,x]);const se=g.useMemo(()=>{const e=[],t=new Date(l.joiningDate),a=new Date;let n=new Date(t.getFullYear(),t.getMonth(),1);const r=a.getFullYear(),s=a.getMonth();for(;n.getFullYear()<r||n.getFullYear()===r&&n.getMonth()<=s;){const t=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`,a=n.toLocaleString("ar-EG",{month:"long",year:"numeric"});e.push({month:t,name:a}),n.setMonth(n.getMonth()+1)}return e.reverse()},[l.joiningDate]),oe=g.useMemo(()=>{const e=new Set,t=new Date;let a=new Date(l.joiningDate);a.setDate(1);let n=new Date(a);for(;n<=t;)e.add(n.toISOString().substring(0,7)),n.setMonth(n.getMonth()+1);return[{value:"current_week",label:"Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ"},{value:"last_week",label:"Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ù…Ø§Ø¶ÙŠ"},...Array.from(e).sort().reverse().map(e=>({value:e,label:new Date(e+"-02").toLocaleString("ar-EG",{month:"long",year:"numeric"})})),{value:"last_3_months",label:"Ø¢Ø®Ø± 3 Ø£Ø´Ù‡Ø±"},{value:"all_time",label:"Ù…Ù†Ø° Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©"}]},[l.joiningDate]),ie=g.useMemo(()=>{if("last_3_months"===ee){const e=[],t=new Date;for(let a=0;a<3;a++){const l=new Date(t.getFullYear(),t.getMonth()-a,1);e.push(l.toISOString().substring(0,7))}return e}return"all_time"===ee?oe.filter(e=>e.value.match(/^\d{4}-\d{2}$/)).map(e=>e.value).sort():[ee]},[ee,oe]),de=g.useMemo(()=>{let e;if("current_week"===ee||"last_week"===ee){const t=new Date,a=(t.getDay()+1)%7,l=new Date(t);l.setDate(t.getDate()-a),l.setHours(0,0,0,0),"last_week"===ee&&l.setDate(l.getDate()-7);const n=new Date(l);n.setDate(l.getDate()+6),n.setHours(23,59,59,999),e=e=>{const t=new Date(e);return t>=l&&t<=n}}else e=e=>ie.some(t=>e.startsWith(t));const t=l.attendance.filter(t=>e(t.date)),a=t.filter(e=>e.status===n.PRESENT).length,r=t.filter(e=>e.status===n.ABSENT).length,s=(ee.includes("week")?[(new Date).toISOString().substring(0,7)]:ie.filter(e=>new Date(e)>=new Date(l.joiningDate.substring(0,7)))).filter(e=>!l.fees.some(t=>t.month===e&&t.paid)),o=l.tests.filter(t=>e(t.date)).sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()),i=o[0]||null,d=e=>o.find(t=>t.type===e)||null,m=d(c.NEW),h=d(c.RECENT_PAST),u=d(c.DISTANT_PAST);return{present:a,absent:r,pendingMonthsCount:s.length,latestTest:i,latestNewTest:m,latestRecentPastTest:h,latestDistantPastTest:u}},[l,ie,ee]),ce=e=>{if(!e)return[];const t=new Set;return e.forEach(e=>{t.add(e.date.substring(0,7))}),Array.from(t).sort().reverse()},me=g.useMemo(()=>ce(l.tests||[]),[l.tests]),he=g.useMemo(()=>ce(l.attendance||[]),[l.attendance]),ue=g.useMemo(()=>{let e=[...l.tests];return"all"!==Y&&(e=e.filter(e=>e.date.startsWith(Y))),"all"!==q&&(e=e.filter(e=>e.type===q)),e.sort((e,t)=>{const a=new Date(e.date).getTime(),l=new Date(t.date).getTime();return"asc"===X?a-l:l-a}),e},[l.tests,Y,q,X]),ge=g.useMemo(()=>{const e=[...l.attendance].sort((e,t)=>{const a=new Date(e.date).getTime(),l=new Date(t.date).getTime();return"asc"===Q?a-l:l-a});return"all"===K?e:e.filter(e=>e.date.startsWith(K))},[l.attendance,K,Q]),pe=e=>{const t="py-3 px-2 font-semibold text-center transition-colors duration-200 focus:outline-none flex-shrink-0 flex items-center justify-center gap-2 flex-grow text-sm";return R===e?`${t} border-b-2 border-blue-600 text-blue-600 bg-blue-50`:`${t} text-gray-500 hover:bg-gray-100`};return de?e("div",{className:"min-h-screen bg-gray-50 flex flex-col pb-20 sm:pb-0",children:[e("header",{className:"bg-white border-b sticky top-0 z-10 shadow-sm",children:[e("div",{className:"container mx-auto px-4 h-16 flex items-center gap-4",children:[t("button",{onClick:L,className:"p-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:t(m,{className:"w-6 h-6"})}),t("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800 truncate",children:l.name})]}),t("div",{className:"bg-white border-t border-gray-200 overflow-x-auto",children:e("div",{className:"container mx-auto flex",children:[e("button",{onClick:()=>_("attendanceLog"),className:pe("attendanceLog"),title:"Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±",children:[t(h,{className:"w-5 h-5"}),t("span",{className:"hidden sm:inline",children:"Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±"})]}),e("button",{onClick:()=>_("progressPlan"),className:pe("progressPlan"),title:"Ø®Ø·Ø© Ø§Ù„Ø³ÙŠØ±",children:[t(v,{className:"w-5 h-5"}),t("span",{className:"hidden sm:inline",children:"Ø®Ø·Ø© Ø§Ù„Ø³ÙŠØ±"})]}),e("button",{onClick:()=>_("tests"),className:pe("tests"),title:"Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª",children:[t(b,{className:"w-5 h-5"}),t("span",{className:"hidden sm:inline",children:"Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª"})]}),e("button",{onClick:()=>_("fees"),className:pe("fees"),title:"Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª",children:[t(o,{className:"w-5 h-5"}),t("span",{className:"hidden sm:inline",children:"Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª"})]}),e("button",{onClick:()=>_("notes"),className:pe("notes"),title:"Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª",children:[t(i,{className:"w-5 h-5"}),t("span",{className:"hidden sm:inline",children:"Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª"})]}),e("button",{onClick:()=>_("reports"),className:pe("reports"),title:"Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ø§Ù…Ù„",children:[t(u,{className:"w-5 h-5"}),t("span",{className:"hidden sm:inline",children:"Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ø§Ù…Ù„"})]})]})})]}),e("main",{className:"container mx-auto p-4 flex-grow",children:["attendanceLog"===R&&e("div",{children:[e("div",{className:"flex justify-between items-center mb-4",children:[t("h4",{className:"font-bold text-gray-700",children:"Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨"}),e("div",{className:"flex gap-2",children:[e("select",{value:K,onChange:e=>J(e.target.value),className:"text-sm px-2 py-1 border rounded-md bg-white",children:[t("option",{value:"all",children:"ÙƒÙ„ Ø§Ù„Ø´Ù‡ÙˆØ±"}),he.map(e=>t("option",{value:e,children:new Date(e+"-02").toLocaleString("ar-EG",{month:"long",year:"numeric"})},e))]}),e("select",{value:Q,onChange:e=>Z(e.target.value),className:"text-sm px-2 py-1 border rounded-md bg-white",children:[t("option",{value:"desc",children:"Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹"}),t("option",{value:"asc",children:"Ø§Ù„Ø£Ù‚Ø¯Ù… Ø£ÙˆÙ„Ø§Ù‹"})]})]})]}),t("div",{className:"space-y-3",children:ge.length>0?ge.map(a=>e("div",{className:"flex justify-between items-center bg-white p-4 rounded-xl shadow-sm border border-gray-100",children:[t("span",{className:"font-medium text-gray-700",children:new Date(a.date).toLocaleDateString("ar-EG",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),a.status===n.PRESENT?t("span",{className:"px-4 py-1.5 text-sm font-bold bg-green-100 text-green-700 rounded-full",children:"Ø­Ø§Ø¶Ø±"}):t("span",{className:"px-4 py-1.5 text-sm font-bold bg-red-100 text-red-700 rounded-full",children:"ØºØ§Ø¦Ø¨"})]},a.date)):t("p",{className:"text-gray-500 text-center py-20 bg-white rounded-xl",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ Ø­Ø¶ÙˆØ± Ù…Ø³Ø¬Ù„."})})]}),"progressPlan"===R&&e("div",{className:"max-w-3xl mx-auto",children:[e("div",{className:"bg-white p-6 rounded-2xl border shadow-sm mb-8",children:[e("h4",{className:"font-bold text-gray-800 mb-6 flex items-center gap-2",children:[t(v,{className:"w-6 h-6 text-blue-600"}),"Ø¥Ø¶Ø§ÙØ© Ø®Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø©"]}),t("div",{className:"space-y-6",children:Object.values(c).filter(e=>e!==c.READING).map(a=>e("div",{children:[t("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:k[a]}),e("div",{className:"flex gap-2",children:[t("textarea",{value:ae[a]||"",onChange:e=>le(t=>({...t,[a]:e.target.value})),rows:2,className:"w-full px-4 py-3 border rounded-xl bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-200 transition-all text-sm",placeholder:`Ø£Ø¯Ø®Ù„ Ù‡Ø¯Ù ${k[a]}...`}),t("button",{onClick:()=>{const e="director"===f?.role?"Ø§Ù„Ù…Ø¯ÙŠØ±":f?.name||"Ù…Ø¬Ù‡ÙˆÙ„";E(l.id,{[a]:ae[a]},e),le(e=>({...e,[a]:""}))},className:"p-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 flex-shrink-0 self-start shadow-md shadow-blue-100 transition-all active:scale-95",title:`Ø­ÙØ¸ ${k[a]} ÙÙ‚Ø·`,children:t(D,{className:"w-6 h-6"})})]})]},a))}),e("div",{className:"mt-8 flex flex-col sm:flex-row gap-4 justify-between items-center border-t pt-6",children:[("director"===f?.role||"supervisor"===f?.role)&&e("button",{onClick:()=>(e=>{const t=e[c.NEW]||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯",a=e[c.RECENT_PAST]||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯",n=e[c.DISTANT_PAST]||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯";let r=`Ù…Ø±Ø­Ø¨Ø§Ù‹ ÙˆÙ„ÙŠ Ø£Ù…Ø± Ø§Ù„Ø·Ø§Ù„Ø¨/Ø©: *${l.name}*.\n`;r+="Ù†Ø±Ø­Ø¨ Ø¨ÙƒÙ… ÙÙŠ Ù…Ø±ÙƒØ² Ø§Ù„Ø´Ø§Ø·Ø¨ÙŠ ÙˆÙŠØ³Ø¹Ø¯Ù†Ø§ Ø£Ù† Ù†Ø´Ø§Ø±ÙƒÙƒÙ… Ø®Ø·Ø© Ø³ÙŠØ± Ø§Ù„Ø·Ø§Ù„Ø¨/Ø©:\n\n",r+=`- Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${t}\n`,r+=`- Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø§Ù„Ù‚Ø±ÙŠØ¨: ${a}\n`,r+=`- Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø§Ù„Ø¨Ø¹ÙŠØ¯: ${n}\n\n`,r+="Ù…Ø¹ ØªØ­ÙŠØ§Øª Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ².";let s=l.phone.replace(/[^0-9]/g,"");if(s=s.replace(/^0+/,""),s.startsWith("1")&&10===s.length&&(s="20"+s),!s)return void alert("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù…Ø³Ø¬Ù„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨.");const o=encodeURIComponent(r);/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)?window.open(`https://api.whatsapp.com/send?phone=${s}&text=${o}`,"_blank"):window.open(`https://web.whatsapp.com/send?phone=${s}&text=${o}`,"whatsapp_window")})(ae),className:"w-full sm:w-auto flex items-center justify-center gap-2 px-6 py-3 rounded-xl text-green-700 bg-green-50 hover:bg-green-100 transition-colors font-bold border border-green-200",children:[t(s,{className:"w-6 h-6"}),t("span",{children:"Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©"})]}),t("button",{onClick:()=>{const e="director"===f?.role?"Ø§Ù„Ù…Ø¯ÙŠØ±":f?.name||"Ù…Ø¬Ù‡ÙˆÙ„";E(l.id,ae,e),le({[c.NEW]:"",[c.RECENT_PAST]:"",[c.DISTANT_PAST]:""}),alert("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®Ø·Ø© Ø¨Ù†Ø¬Ø§Ø­!")},className:"w-full sm:w-auto px-10 py-3 rounded-xl text-white bg-blue-600 hover:bg-blue-700 transition-all font-bold shadow-lg shadow-blue-100 active:scale-95",children:"Ø­ÙØ¸ Ø§Ù„ÙƒÙ„ Ù„Ù„Ø³Ø¬Ù„"})]})]}),t("h4",{className:"font-bold text-gray-800 mb-4 px-2",children:"Ø³Ø¬Ù„ Ø§Ù„Ø®Ø·Ø· Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©"}),t("div",{className:"space-y-4",children:l.progressPlanHistory&&l.progressPlanHistory.length>0?[...l.progressPlanHistory].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).map(a=>t("div",{className:"p-5 rounded-2xl border transition-all "+(a.isCompleted?"bg-green-50/50 border-green-100":"bg-white border-gray-100 shadow-sm"),children:e("div",{className:"flex justify-between items-start",children:[e("div",{className:"flex-grow "+(a.isCompleted?"text-gray-500 line-through":"text-gray-800"),children:[e("div",{className:"flex items-center gap-2 mb-3",children:[t("span",{className:"text-xs font-bold text-gray-400 bg-gray-100 px-2 py-1 rounded-md",children:new Date(a.date).toLocaleDateString("ar-EG")}),e("span",{className:"text-xs font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded-md",children:["Ø¨ÙˆØ§Ø³Ø·Ø©: ",a.authorName]})]}),e("div",{className:"mt-2 text-sm space-y-2",children:[a.plan[c.NEW]&&e("p",{className:"bg-white/50 p-2 rounded-lg border border-gray-50",children:[t("span",{className:"font-bold text-blue-700 mr-1",children:"Ø§Ù„Ø¬Ø¯ÙŠØ¯:"})," ",a.plan[c.NEW]]}),a.plan[c.RECENT_PAST]&&e("p",{className:"bg-white/50 p-2 rounded-lg border border-gray-50",children:[t("span",{className:"font-bold text-indigo-700 mr-1",children:"Ø§Ù„Ù‚Ø±ÙŠØ¨:"})," ",a.plan[c.RECENT_PAST]]}),a.plan[c.DISTANT_PAST]&&e("p",{className:"bg-white/50 p-2 rounded-lg border border-gray-50",children:[t("span",{className:"font-bold text-purple-700 mr-1",children:"Ø§Ù„Ø¨Ø¹ÙŠØ¯:"})," ",a.plan[c.DISTANT_PAST]]})]})]}),e("div",{className:"flex flex-col items-center gap-3 flex-shrink-0 mr-4",children:[t("button",{onClick:()=>$(l.id,a.id),title:a.isCompleted?"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„":"ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© ÙƒÙ…ÙƒØªÙ…Ù„",className:"active:scale-90 transition-transform",children:t(p,{className:"w-8 h-8 "+(a.isCompleted?"text-green-500":"text-gray-300 hover:text-green-400")})}),("director"===f?.role||"supervisor"===f?.role)&&t("button",{onClick:()=>A(l.id,a.id),title:"Ø­Ø°Ù Ø§Ù„Ø®Ø·Ø©",className:"p-2 hover:bg-red-50 rounded-lg transition-colors group",children:t(r,{className:"w-5 h-5 text-gray-400 group-hover:text-red-500"})})]})]})},a.id)):t("p",{className:"text-center text-gray-500 py-12 bg-white rounded-2xl border border-dashed",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ Ù„Ù„Ø®Ø·Ø· Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©."})})]}),"fees"===R&&e("div",{className:"max-w-4xl mx-auto space-y-8",children:[e("section",{children:[t("h4",{className:"font-bold text-gray-700 mb-4 px-2",children:"Ø³Ø±Ø¹Ø© Ø§Ù„Ø¯ÙØ¹ Ù„Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ ÙˆØ§Ù„Ù…Ø§Ø¶ÙŠ"}),t("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:se.slice(0,6).map(({month:a,name:n})=>{const r=l.fees.find(e=>e.month===a);return e("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-gray-100 flex flex-col justify-between gap-4",children:[e("div",{children:[t("h5",{className:"font-bold text-gray-800",children:n}),t("p",{className:"text-sm text-gray-500",children:r?.paid?"ØªÙ… Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­":"Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¨Ø¹Ø¯"})]}),t("button",r?.paid?{onClick:()=>j(l.id,a),className:"w-full py-2.5 text-sm font-bold bg-yellow-50 text-yellow-700 border border-yellow-200 rounded-xl hover:bg-yellow-100 transition-colors",children:"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø³Ø¯Ø§Ø¯"}:{onClick:()=>N(l.id,a,l.monthlyFee),className:"w-full py-2.5 text-sm font-bold bg-blue-600 text-white rounded-xl hover:bg-blue-700 shadow-lg shadow-blue-100 transition-all active:scale-95",children:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯ÙØ¹"})]},a)})})]}),e("section",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden text-center",children:[t("div",{className:"p-4 border-b bg-gray-50/50",children:t("h3",{className:"text-lg font-bold text-gray-800",children:"Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ"})}),t("div",{className:"overflow-x-auto",children:e("table",{className:"min-w-full divide-y divide-gray-200",children:[t("thead",{className:"bg-white",children:e("tr",{children:[t("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Ø§Ù„Ø´Ù‡Ø±"}),t("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-400 uppercase tracking-wider text-center",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯ÙØ¹"}),t("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-400 uppercase tracking-wider text-center",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),t("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-400 uppercase tracking-wider text-center",children:"Ø±Ù‚Ù… Ø§Ù„ÙˆØµÙ„"}),t("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-400 uppercase tracking-wider text-center",children:"Ø§Ù„Ù…Ø­ØµÙ„"})]})}),t("tbody",{className:"bg-white divide-y divide-gray-100",children:l.fees.filter(e=>e.paid).length>0?l.fees.filter(e=>e.paid).sort((e,t)=>(t.paymentDate||"").localeCompare(e.paymentDate||"")).map((a,l)=>e("tr",{className:"hover:bg-gray-50/50 transition-colors",children:[t("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-bold",children:new Date(a.month+"-02").toLocaleString("ar-EG",{month:"long",year:"numeric"})}),t("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center",children:a.paymentDate?new Date(a.paymentDate).toLocaleDateString("ar-EG"):"-"}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 font-bold text-center",children:[a.amountPaid||a.amount," Ø¬.Ù…"]}),t("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center",children:a.receiptNumber||"-"}),t("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center",children:a.collectedByName||"-"})]},l)):t("tr",{children:t("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500 italic",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¯ÙÙˆØ¹Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ø¨Ø¹Ø¯."})})})]})})]})]}),"tests"===R&&e("div",{className:"max-w-4xl mx-auto space-y-8",children:[e("section",{className:"bg-white p-6 rounded-2xl border shadow-sm",children:[t("h4",{className:"font-bold text-gray-800 mb-6",children:"Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯"}),e("form",{onSubmit:e=>{e.preventDefault(),M?(y(l.id,{suraName:M,type:W,grade:O}),F(""),I(c.NEW),G(d.EXCELLENT)):alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ±Ø©.")},className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 items-end",children:[e("div",{className:"sm:col-span-2 md:col-span-1",children:[t("label",{htmlFor:`suraName-${l.id}`,className:"block text-sm font-bold text-gray-600 mb-2",children:"Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ±Ø©"}),t("input",{type:"text",id:`suraName-${l.id}`,value:M,onChange:e=>F(e.target.value),className:"w-full px-4 py-2 border rounded-xl bg-gray-50 focus:ring-2 focus:ring-blue-100 outline-none transition-all",required:!0})]}),e("div",{children:[t("label",{htmlFor:`testType-${l.id}`,className:"block text-sm font-bold text-gray-600 mb-2",children:"Ù†ÙˆØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±"}),t("select",{id:`testType-${l.id}`,value:W,onChange:e=>I(e.target.value),className:"w-full px-4 py-2 border rounded-xl bg-white outline-none",children:Object.entries(k).map(([e,a])=>t("option",{value:e,children:a},e))})]}),e("div",{children:[t("label",{htmlFor:`testGrade-${l.id}`,className:"block text-sm font-bold text-gray-600 mb-2",children:"Ø§Ù„ØªÙ‚Ø¯ÙŠØ±"}),t("select",{id:`testGrade-${l.id}`,value:O,onChange:e=>G(e.target.value),className:"w-full px-4 py-2 border rounded-xl bg-white outline-none",children:Object.entries(S).map(([e,{label:a}])=>t("option",{value:e,children:a},e))})]}),t("button",{type:"submit",className:"px-8 py-2.5 font-bold bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-all shadow-lg shadow-blue-100 active:scale-95",children:"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±"})]})]}),e("section",{children:[e("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[t("h4",{className:"font-bold text-gray-800",children:"Ø³Ø¬Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª"}),e("div",{className:"flex flex-wrap justify-center items-center gap-2",children:[e("select",{value:Y,onChange:e=>H(e.target.value),className:"text-xs px-3 py-2 border rounded-xl bg-white outline-none shadow-sm",children:[t("option",{value:"all",children:"ÙƒÙ„ Ø§Ù„Ø´Ù‡ÙˆØ±"}),me.map(e=>t("option",{value:e,children:new Date(e+"-02").toLocaleString("ar-EG",{month:"long",year:"numeric"})},e))]}),e("select",{value:q,onChange:e=>V(e.target.value),className:"text-xs px-3 py-2 border rounded-xl bg-white outline-none shadow-sm",children:[t("option",{value:"all",children:"ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹"}),Object.entries(k).map(([e,a])=>t("option",{value:e,children:a},e))]}),e("select",{value:X,onChange:e=>z(e.target.value),className:"text-xs px-3 py-2 border rounded-xl bg-white outline-none shadow-sm",children:[t("option",{value:"desc",children:"Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹"}),t("option",{value:"asc",children:"Ø§Ù„Ø£Ù‚Ø¯Ù… Ø£ÙˆÙ„Ø§Ù‹"})]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ue.length>0?ue.map(a=>e("div",{className:"flex justify-between items-center bg-white p-5 rounded-2xl shadow-sm border border-gray-100 group",children:[e("div",{children:[e("p",{className:"font-bold text-gray-800 text-lg",children:[a.suraName," ",e("span",{className:"text-sm font-normal text-gray-400",children:["(",k[a.type],")"]})]}),t("p",{className:"text-xs font-bold text-blue-500 mt-1",children:new Date(a.date).toLocaleDateString("ar-EG",{day:"numeric",month:"long",year:"numeric"})})]}),e("div",{className:"flex items-center gap-4",children:[t("span",{className:`px-4 py-1.5 text-sm font-bold rounded-full ${S[a.grade].className}`,children:S[a.grade].label}),t("button",{onClick:()=>{return e=l.id,t=a.id,void(window.confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.")&&T(e,t));var e,t},className:"p-2 text-gray-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all",title:"Ø­Ø°Ù Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±",children:t(r,{className:"w-5 h-5"})})]})]},a.id)):t("div",{className:"col-span-full py-20 bg-white rounded-2xl border border-dashed text-center text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù…Ø³Ø¬Ù„Ø© ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ØªØµÙÙŠØ©."})})]})]}),"notes"===R&&e("div",{className:"max-w-3xl mx-auto space-y-8",children:[e("section",{className:"bg-white p-6 rounded-2xl border shadow-sm",children:[t("h4",{className:"font-bold text-gray-800 mb-4",children:"Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø­ÙˆØ¸Ø© Ø¬Ø¯ÙŠØ¯Ø©"}),e("form",{onSubmit:e=>{e.preventDefault(),""!==B.trim()&&(C(l.id,B.trim()),U(""))},className:"space-y-4",children:[t("textarea",{value:B,onChange:e=>U(e.target.value),rows:4,placeholder:"Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ø§Ù„Ù…Ù‡Ù…Ø© Ù‡Ù†Ø§ Ø¹Ù† Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø£Ùˆ Ø³Ù„ÙˆÙƒÙ‡...",className:"w-full px-5 py-4 border rounded-2xl bg-gray-50 outline-none focus:ring-2 focus:ring-blue-100 transition-all"}),t("div",{className:"flex justify-end",children:t("button",{type:"submit",className:"px-10 py-3 font-bold bg-blue-600 text-white rounded-xl hover:bg-blue-700 shadow-lg shadow-blue-100 active:scale-95 transition-all",children:"Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø­ÙˆØ¸Ø©"})})]})]}),e("section",{children:[t("h4",{className:"font-bold text-gray-800 mb-4 px-2",children:"Ø³Ø¬Ù„ Ø§Ù„Ù…Ù„Ø­ÙˆØ¸Ø§Øª"}),t("div",{className:"space-y-4",children:w.length>0?w.map(a=>e("div",{className:"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm relative overflow-hidden group",children:[t("div",{className:"absolute top-0 right-0 w-1.5 h-full bg-blue-400 opacity-0 group-hover:opacity-100 transition-opacity"}),t("p",{className:"text-gray-800 leading-relaxed",children:a.content}),e("div",{className:"mt-4 pt-4 border-t border-gray-50 flex justify-between items-center text-xs font-bold",children:[e("span",{className:"text-blue-600 bg-blue-50 px-2.5 py-1 rounded-md",children:["Ø¨ÙˆØ§Ø³Ø·Ø©: ",a.authorName]}),t("span",{className:"text-gray-400",children:new Date(a.date).toLocaleDateString("ar-EG",{day:"numeric",month:"long",year:"numeric"})})]})]},a.id)):t("div",{className:"py-20 bg-white rounded-2xl border border-dashed text-center text-gray-500 italic",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø­ÙˆØ¸Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹."})})]})]}),"reports"===R&&t("div",{className:"max-w-4xl mx-auto",children:e("div",{className:"bg-white rounded-3xl p-6 sm:p-8 shadow-sm border border-gray-100 relative overflow-hidden",children:[t("div",{className:"absolute top-0 left-0 right-0 h-2 bg-gradient-to-r from-blue-400 to-indigo-500"}),e("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-10 gap-6",children:[e("div",{children:[e("h3",{className:"text-2xl font-black text-gray-900 mb-2 flex items-center gap-3",children:[t(u,{className:"w-8 h-8 text-blue-600"}),"Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù„Ø·Ø§Ù„Ø¨"]}),t("p",{className:"text-gray-500 font-bold",children:"Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„ØªÙ‚Ø¯Ù… Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ"})]}),e("div",{className:"w-full sm:w-64",children:[t("label",{className:"block text-xs font-black text-gray-400 uppercase tracking-wider mb-2 mr-1",children:"Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©"}),t("select",{value:ee,onChange:e=>te(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-2xl bg-gray-50 font-bold text-gray-700 outline-none focus:ring-2 focus:ring-blue-100 transition-all cursor-pointer",children:oe.map(e=>t("option",{value:e.value,children:e.label},e.value))})]})]}),e("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:[e("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-3xl border border-green-100 relative group overflow-hidden",children:[t("div",{className:"absolute -right-4 -bottom-4 w-24 h-24 bg-green-200/20 rounded-full blur-2xl group-hover:bg-green-300/30 transition-all"}),e("h4",{className:"font-black text-green-800 mb-4 flex items-center justify-between",children:[t("span",{children:"Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨"}),t(h,{className:"w-6 h-6 opacity-30"})]}),e("div",{className:"space-y-2",children:[e("div",{className:"flex justify-between items-end",children:[t("span",{className:"text-sm font-bold text-green-600/70",children:"Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±"}),t("span",{className:"text-2xl font-black text-green-600",children:de.present})]}),e("div",{className:"flex justify-between items-end border-t border-green-200/50 pt-2",children:[t("span",{className:"text-sm font-bold text-red-600/70",children:"Ø£ÙŠØ§Ù… Ø§Ù„ØºÙŠØ§Ø¨"}),t("span",{className:"text-2xl font-black text-red-600",children:de.absent})]})]})]}),e("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-3xl border border-blue-100 relative group overflow-hidden",children:[t("div",{className:"absolute -right-4 -bottom-4 w-24 h-24 bg-blue-200/20 rounded-full blur-2xl group-hover:bg-blue-300/30 transition-all"}),e("h4",{className:"font-black text-blue-800 mb-4 flex items-center justify-between",children:[t("span",{children:"Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª"}),t(o,{className:"w-6 h-6 opacity-30"})]}),t("div",{className:"h-full flex flex-col justify-center",children:de.pendingMonthsCount>0?e("div",{className:"text-center",children:[t("p",{className:"text-red-500 font-black text-3xl mb-1",children:de.pendingMonthsCount}),t("p",{className:"text-xs font-bold text-red-400",children:"Ø´Ù‡ÙˆØ± Ù„Ù… ØªØ³Ø¯Ø¯"})]}):e("div",{className:"flex flex-col items-center",children:[t(p,{className:"w-12 h-12 text-blue-500 mb-2 drop-shadow-sm"}),t("span",{className:"text-sm font-black text-blue-600",children:"Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ù‡ÙˆØ± Ù…Ø³Ø¯Ø¯Ø©"})]})})]}),e("div",{className:"bg-gradient-to-br from-purple-50 to-fuchsia-50 p-6 rounded-3xl border border-purple-100 relative group overflow-hidden",children:[t("div",{className:"absolute -right-4 -bottom-4 w-24 h-24 bg-purple-200/20 rounded-full blur-2xl group-hover:bg-purple-300/30 transition-all"}),e("h4",{className:"font-black text-purple-800 mb-4 flex items-center justify-between",children:[t("span",{children:"Ø¢Ø®Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª"}),t(b,{className:"w-6 h-6 opacity-30"})]}),e("div",{className:"space-y-2 text-xs font-bold text-purple-600/80",children:[e("p",{className:"flex justify-between border-b border-purple-200/30 pb-1",children:["Ø§Ù„Ø¬Ø¯ÙŠØ¯: ",t("span",{className:"text-purple-900 truncate max-w-[80px] text-left",children:de.latestNewTest?.suraName||"-"})]}),e("p",{className:"flex justify-between border-b border-purple-200/30 pb-1",children:["Ø§Ù„Ù‚Ø±ÙŠØ¨: ",t("span",{className:"text-purple-900 truncate max-w-[80px] text-left",children:de.latestRecentPastTest?.suraName||"-"})]}),e("p",{className:"flex justify-between",children:["Ø§Ù„Ø¨Ø¹ÙŠØ¯: ",t("span",{className:"text-purple-900 truncate max-w-[80px] text-left",children:de.latestDistantPastTest?.suraName||"-"})]})]})]})]}),e("div",{className:"bg-blue-600 p-8 rounded-[2.5rem] shadow-xl shadow-blue-200 flex flex-col sm:flex-row items-center justify-between gap-6 transition-transform hover:scale-[1.01]",children:[e("div",{className:"text-white text-center sm:text-right",children:[t("h4",{className:"text-xl font-black mb-1",children:"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù„ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±"}),t("p",{className:"text-blue-100 font-bold opacity-80",children:"Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø© Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ ÙÙˆØ±Ø§Ù‹"})]}),e("button",{onClick:e=>{e.stopPropagation(),(()=>{if(!de)return;const e=oe.find(e=>e.value===ee)?.label||ee;let t=`Ù…Ø±Ø­Ø¨Ø§Ù‹ ÙˆÙ„ÙŠ Ø£Ù…Ø± Ø§Ù„Ø·Ø§Ù„Ø¨/Ø©: *${l.name}*\n`;if(t+=`Ù‡Ø°Ø§ Ù‡Ùˆ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø¯Ø§Ø¡ Ù…Ù† Ù…Ø±ÙƒØ² Ø§Ù„Ø´Ø§Ø·Ø¨ÙŠ Ø¹Ù† ÙØªØ±Ø©: *${e}*\n\n`,t+="*ğŸ“ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨:*\n",t+=`  - Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±: ${de.present}\n`,t+=`  - Ø£ÙŠØ§Ù… Ø§Ù„ØºÙŠØ§Ø¨: ${de.absent}\n\n`,!ee.includes("week")){const e=ie.filter(e=>new Date(e)>=new Date(l.joiningDate.substring(0,7))).filter(e=>!l.fees.some(t=>t.month===e&&t.paid));if(t+="*ğŸ’µ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª:*\n",e.length>0){const a=e.map(e=>new Date(e+"-02").toLocaleString("ar-EG",{month:"long"})).join(", ");t+=`  - ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø§Ø­Ø¸Ø© Ø£Ù† Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ø´Ù‡ÙˆØ± Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ù… ØªØ³Ø¯Ø¯ Ø¨Ø¹Ø¯: *${a}*.\n\n`}else t+="  - Ø¬Ù…ÙŠØ¹ Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ù…Ø³Ø¯Ø¯Ø©. Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ù„ØªØ²Ø§Ù…ÙƒÙ….\n\n"}t+="*ğŸ“– Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª:*\n";const a=[{label:"Ø¢Ø®Ø± Ø§Ø®ØªØ¨Ø§Ø±",test:de.latestTest},{label:"Ø§Ù„Ø¬Ø¯ÙŠØ¯",test:de.latestNewTest},{label:"Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø§Ù„Ù‚Ø±ÙŠØ¨",test:de.latestRecentPastTest},{label:"Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø§Ù„Ø¨Ø¹ÙŠØ¯",test:de.latestDistantPastTest}];a.some(e=>e.test)?(a.forEach(({label:e,test:a})=>{t+=a?`  - ${e}: ${a.suraName} - *${S[a.grade].label}*\n`:`  - ${e}: Ù„Ù… ÙŠØ³Ø¬Ù„\n`}),t+="\n"):t+="  - Ù„Ù… ØªØ³Ø¬Ù„ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù„Ù„Ø·Ø§Ù„Ø¨/Ø© Ø®Ù„Ø§Ù„ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©.\n\n",t+="Ù…Ø¹ ØªØ­ÙŠØ§Øª Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ².";let n=l.phone.replace(/[^0-9]/g,"");n=n.replace(/^0+/,""),n.startsWith("1")&&10===n.length&&(n="20"+n);const r=encodeURIComponent(t);/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)?window.open(`https://api.whatsapp.com/send?phone=${n}&text=${r}`,"_blank"):window.open(`https://web.whatsapp.com/send?phone=${n}&text=${r}`,"whatsapp_window")})()},className:"w-full sm:w-auto flex items-center justify-center gap-3 bg-white text-blue-600 font-black py-4 px-10 rounded-2xl shadow-lg hover:bg-gray-50 transition-all active:scale-95 group",children:[t(s,{className:"w-7 h-7 text-green-500 group-hover:scale-110 transition-transform"}),t("span",{children:"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¢Ù†"})]})]})]})})]})]}):null};export{x as A,f as S,y as a,T as b,w as c};
